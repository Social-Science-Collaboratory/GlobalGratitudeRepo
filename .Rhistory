"Long term orientation",
"Indulgence"
)
))
View(results)
results <- do.call(rbind, results) %>% as.data.frame()
colnames(results)
colnames(results)
results <- sapply(
X = seq_len(nrow(expanded.list)),
simplify = FALSE,
FUN = function(i) {
df <- DF %>%
select(
expanded.list$out.list[i],
expanded.list$mod.list[i]
)
names(df) <- c("x", "y")
# Pearson correlation
cor.est <- cor(
x = df$x,
y = df$y,
use = "pairwise.complete.obs",
method = "pearson"
)
# Bayes factor
bf.est <- correlationBF(
x = df$x,
y = df$y
)
# Correlation test (gives CI + p)
cor.test.res <- cor.test(
df$x, df$y,
method = "pearson",
use = "pairwise.complete.obs"
)
data.frame(
outcome = expanded.list$out.list[i],
moderator = expanded.list$mod.list[i],
cor.est = cor.est,
bf = extractBF(bf.est)$bf,
ci.lower = cor.test.res$conf.int[1],
ci.upper = cor.test.res$conf.int[2]
)
}
) %>% do.call(rbind, .)
colnames(results)
results <- results %>%
mutate(
`cor.est` = as.numeric(`cor.est`),
`cor.est` = round(`cor.est`, 2),
bf = as.numeric(bf),
logbf = round(log(bf), 2),
ci.lower = round(as.numeric(ci.lower), 2),
ci.upper = round(as.numeric(ci.upper), 2)
)
expanded.list <-
expand_grid(
out.list,
mod.list
)
results <- sapply(
X = seq_len(nrow(expanded.list)),
simplify = FALSE,
FUN = function(i) {
df <- DF %>%
select(
expanded.list$out.list[i],
expanded.list$mod.list[i]
)
names(df) <- c("x", "y")
# Pearson correlation
cor.est <- cor(
x = df$x,
y = df$y,
use = "pairwise.complete.obs",
method = "pearson"
)
# Bayes factor
bf.est <- correlationBF(
x = df$x,
y = df$y
)
# Correlation test (gives CI + p)
cor.test.res <- cor.test(
df$x, df$y,
method = "pearson",
use = "pairwise.complete.obs"
)
data.frame(
outcome = expanded.list$out.list[i],
moderator = expanded.list$mod.list[i],
cor.est = cor.est,
bf = extractBF(bf.est)$bf,
ci.lower = cor.test.res$conf.int[1],
ci.upper = cor.test.res$conf.int[2]
)
}
) %>% do.call(rbind, .)
results <- sapply(
X = seq_len(nrow(expanded.list)),
simplify = FALSE,
FUN = function(i) {
df <- DF %>%
select(
expanded.list$out.list[i],
expanded.list$mod.list[i]
)
names(df) <- c("x", "y")
# Pearson correlation
cor.est <- cor(
x = df$x,
y = df$y,
use = "pairwise.complete.obs",
method = "pearson"
)
# Bayes factor
bf.est <- correlationBF(
x = df$x,
y = df$y
)
# Correlation test (gives CI + p)
cor.test.res <- cor.test(
df$x, df$y,
method = "pearson",
use = "pairwise.complete.obs"
)
data.frame(
outcome = expanded.list$out.list[i],
moderator = expanded.list$mod.list[i],
cor.est = cor.est,
bf = extractBF(bf.est)$bf,
ci.lower = cor.test.res$conf.int[1],
ci.upper = cor.test.res$conf.int[2]
)
}
)
View(results)
results <-
do.call(rbind, results) %>%
as.data.frame() %>%
mutate(
cor.est = as.numeric(cor.est),
cor.est = round(cor.est, 2),
bf = as.numeric(bf),
logbf = log(bf),
logbf = round(logbf, 2),
ci.lower = round(as.numeric(ci.lower), 2),
ci.upper = round(as.numeric(ci.upper), 2)
)
View(results)
results <-
do.call(rbind, results) %>%
as.data.frame() %>%
mutate(
cor.est = as.numeric(cor.est),
cor.est = round(cor.est, 2),
bf = as.numeric(bf),
logbf = log(bf),
logbf = round(logbf, 2),
ci.lower = round(as.numeric(ci.lower), 2),
ci.upper = round(as.numeric(ci.upper), 2)
) %>%
# clean aesthetics
mutate(outcome = factor(outcome,
levels = c(
"pa_effect_size",
"na_effect_size",
"optimistic_effect_size",
"ls_effect_size",
"envy_effect_size",
"indebted_effect_size"
),
labels = c(
"Positive affect",
"Negative affect",
"Optimism",
"Life satisfaction",
"Envy",
"Indebtedness"
)
)) %>%
mutate(moderator = factor(moderator,
levels = c(
"individualism",
"tightness",
"relational_mobility",
"resmobility",
"responsibilism",
"relig_mean",
"mean_GDP",
"power.distance",
"motivation",
"uncertainty.avoidance",
"long.term.orientation",
"indulgence"
),
labels = c(
"Individualism",
"Tightness",
"Relational mobility",
"Residential mobility",
"Responsibilism",
"Religiosity",
"GDP",
"Power distance",
"Motivation",
"Uncertainty avoidance",
"Long term orientation",
"Indulgence"
)
))
out.list <-
c(
"pa_effect_size",
"na_effect_size",
"optimistic_effect_size",
"ls_effect_size",
"envy_effect_size",
"indebted_effect_size"
)
mod.list <-
c(
"relational_mobility",
"responsibilism",
"tightness",
"relig_mean",
"mean_GDP",
"resmobility",
"power.distance",
"individualism",
"motivation",
"uncertainty.avoidance",
"long.term.orientation",
"indulgence"
)
expanded.list <-
expand_grid(
out.list,
mod.list
)
results <- sapply(
X = seq_len(nrow(expanded.list)),
simplify = FALSE,
FUN = function(i) {
df <- DF %>%
select(
expanded.list$out.list[i],
expanded.list$mod.list[i]
)
names(df) <- c("x", "y")
# Pearson correlation
cor.est <- cor(
x = df$x,
y = df$y,
use = "pairwise.complete.obs",
method = "pearson"
)
# Bayes factor
bf.est <- correlationBF(
x = df$x,
y = df$y
)
# Correlation test (gives CI + p)
cor.test.res <- cor.test(
df$x, df$y,
method = "pearson",
use = "pairwise.complete.obs"
)
data.frame(
outcome = expanded.list$out.list[i],
moderator = expanded.list$mod.list[i],
cor.est = cor.est,
bf = extractBF(bf.est)$bf,
ci.lower = cor.test.res$conf.int[1],
ci.upper = cor.test.res$conf.int[2]
)
}
)
# combine list
results <-
do.call(rbind, results) %>%
as.data.frame() %>%
mutate(
cor.est = as.numeric(cor.est),
cor.est = round(cor.est, 2),
bf = as.numeric(bf),
logbf = log(bf),
logbf = round(logbf, 2),
ci.lower = round(as.numeric(ci.lower), 2),
ci.upper = round(as.numeric(ci.upper), 2)
) %>%
# clean aesthetics
mutate(outcome = factor(outcome,
levels = c(
"pa_effect_size",
"na_effect_size",
"optimistic_effect_size",
"ls_effect_size",
"envy_effect_size",
"indebted_effect_size"
),
labels = c(
"Positive affect",
"Negative affect",
"Optimism",
"Life satisfaction",
"Envy",
"Indebtedness"
)
)) %>%
mutate(moderator = factor(moderator,
levels = c(
"individualism",
"tightness",
"relational_mobility",
"resmobility",
"responsibilism",
"relig_mean",
"mean_GDP",
"power.distance",
"motivation",
"uncertainty.avoidance",
"long.term.orientation",
"indulgence"
),
labels = c(
"Individualism",
"Tightness",
"Relational mobility",
"Residential mobility",
"Responsibilism",
"Religiosity",
"GDP",
"Power distance",
"Motivation",
"Uncertainty avoidance",
"Long term orientation",
"Indulgence"
)
))
# minor edit to label
results <- results %>%
mutate(cor.lab = paste0(
"paste(",
"italic(r), ' = ",
cor.est,
"')"
))
# restructure
results <- results %>%
mutate(
outcome = fct_reorder(outcome, -logbf),
moderator = fct_reorder(moderator, -logbf)
)
# recalculate bf scale
results <- results %>%
mutate(
bf.type =
if_else(bf > .9999,
"BF['1,0']",
"BF['0,1']"
),
bf.tran =
if_else(bf > .9999,
bf,
1 / bf
),
bf.tran =
round(
bf.tran,
2
),
bf.tran.dir =
if_else(bf > .9999,
bf.tran,
bf.tran * (-1)
),
bf.lab =
paste0(
"paste(",
"italic(",
bf.type,
")",
", ' = ",
bf.tran,
"')"
)
)
write.csv(results,
file = here(
"data/output",
"moderators.csv"
)
)
View(results)
fig.3b <-
ggplot(
data = results,
aes(
x = moderator,
y = fct_rev(outcome),
fill = bf.tran.dir,
label = bf.lab
)
) +
geom_tile(aes(color = cor),
size = 1,
width = .97, height = 0.97
) +
scale_color_gradient2(
low = "red", mid = "white", high = "blue",
midpoint = 0, limits = c(-1, 1),
name = expression("Pearson's " * italic("r"))
) +
scale_fill_gradient2(
high = "#1b7837",
mid = "white",
low = "black",
midpoint = 1,
limits = c(-8, 8),
name = "Bayes factor",
labels = c(
"-4" = expression(BF["0,1"] == 4),
"-2" = expression(BF["0,1"] == 2),
"0" = expression(BF["1,0"] == 1),
"2" = expression(BF["1,0"] == 2),
"4" = expression(BF["1,0"] == 4)
)
) +
geom_text(aes(label = bf.lab),
parse = T,
nudge_y = .25,
size = 3.5
) +
geom_label(
aes(
label = cor.lab,
color = cor
),
parse = T,
nudge_y = -.25,
size = 3.5
) +
theme_classic() +
labs(
y =
expression("Country-level effects of gratitude interventions (" * italic("d") * ")"),
x = "Country-level differences",
fill = expression("Pearson's " * italic("r"))
) +
theme(
axis.line = element_blank(),
axis.ticks = element_blank(),
plot.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_text(size = 10, margin = margin(b = 15)),
legend.key.size = unit(.6, "cm")
)
moderators <- read.csv(file = here("data/output", "moderators.csv"))%>%
filter(moderator == "tightness" | row_number() %in% c(36, 43, 65)
moderators <- read.csv(file = here("data/output", "moderators.csv"))%>%
moderators <- read.csv(file = here("data/output", "moderators.csv"))%>%
filter(moderator == "tightness" | row_number() %in% c(36, 43, 65))
View(moderators)
moderators <- read.csv(file = here("data/output", "moderators.csv"))%>%
filter(moderator == "tightness" | row_number() %in% c(36, 43, 65)) %>% select(outcome:ci.upper)
moderators <- read.csv(file = here("data/output", "moderators.csv"))
tightness_rows <- moderators %>% filter(moderator == "tightness")
specific_rows <- moderators[c(36, 43, 65), ]
moderators_selected <- bind_rows(tightness_rows, specific_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
moderators <- read.csv(file = here("data/output", "moderators.csv"))
tightness_rows <- moderators %>% filter(moderator == "tightness")
specific_rows <- moderators[c(36, 43, 65), ]
moderators_selected <- bind_rows(tightness_rows, specific_rows) %>%
select(outcome:ci.upper)
moderators <- read.csv(file = here("data/output", "moderators.csv"))
tightness_rows <- moderators %>% filter(moderator == "Tightness")
specific_rows <- moderators[c(36, 43, 65), ]
moderators_selected <- bind_rows(tightness_rows, specific_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
# Cross-cultural moderators
moderators <- read.csv(file = here("data/output", "moderators.csv"))
specific_rows <- moderators[c(36, 43, 65), ]
tightness_rows <- moderators %>% filter(moderator == "Tightness")
moderators_selected <- bind_rows(specific_rows, tightness_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
tightness_rows <- moderators %>% filter(moderator == "Tightness") %>% select(-6)
moderators_selected <- bind_rows(specific_rows, tightness_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
tightness_rows <- moderators %>% filter(moderator == "Tightness")
View(tightness_rows)
tightness_rows <- moderators %>% filter(moderator == "Tightness") %>% slice(1:5)
moderators_selected <- bind_rows(specific_rows, tightness_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
tightness_rows <- moderators %>% filter(moderator == "Tightness") %>% slice(1:4)
moderators_selected <- bind_rows(specific_rows, tightness_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
moderators <- read.csv(file = here("data/output", "moderators.csv"))
View(moderators)
specific_rows <- moderators[c(36, 43, 64, 65), ]
tightness_rows <- moderators %>% filter(moderator == "Tightness") %>% slice(1:4)
moderators_selected <- bind_rows(specific_rows, tightness_rows) %>%
select(outcome:ci.upper)
print(moderators_selected)
