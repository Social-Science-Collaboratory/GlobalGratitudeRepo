data$Matched[duplicated(data$Matched)]
View(data)
data <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Hofstede_ResMobility.csv")) %>%
select(Matched, resmobility:indulgence) %>%
filter(Matched != "")
View(data)
#Load data (Hofstede + Residential Mobility)
data <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Hofstede_ResMobility.csv")) %>%
select(Matched, resmobility:indulgence) %>%
filter(Matched != "")  %>%
distinct(Matched, .keep_all = TRUE)
country_data <- unique(data$Matched)
#create synthetic version
syn_data <- syn(
data,
maxfaclevels = 154
)
head(syn_data$syn)
syn_data <- syn_data$syn
View(syn_data)
syn_data <- data %>%
slice(1:length(country_data)) %>%
mutate(Matched = country_data)
View(syn_data)
write.csv(,
file = here('data/cross-cultural',
"GlobalGratitude_Hofstede_ResMobility_Syn.csv"),
row.names = F)
write.csv(syn_data,
file = here('data/cross-cultural',
"GlobalGratitude_Hofstede_ResMobility_Syn.csv"),
row.names = F)
data_2 <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism.csv")) %>%
select(Culture:Responsibilism) %>%
filter(Culture != "", Culture == "Total")
country_data_2 <- unique(data_2$Culture)
set.seed(123)
data_2 <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism.csv")) %>%
select(Culture:Responsibilism) %>%
filter(Culture != "", Culture != "Total")
country_data_2 <- unique(data_2$Culture)
set.seed(123)
#create synthetic version
syn_data_2 <- syn(
data_2,
maxfaclevels = 100
)
data <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Hofstede_ResMobility.csv")) %>%
select(Matched, resmobility:indulgence) %>%
filter(Matched != "")  %>%
distinct(Matched, .keep_all = TRUE)
country_data <- unique(data$Matched)
set.seed(123)
#create synthetic version
syn_data <- syn(
data,
maxfaclevels = 154
)
syn_data <- syn_data$syn
syn_data <- syn_data %>%
slice(1:length(country_data)) %>%
mutate(Matched = country_data)
write.csv(syn_data,
file = here('data/cross-cultural',
"GlobalGratitude_Hofstede_ResMobility_Syn.csv"),
row.names = F)
syn_data_2 <- (syn_data_2$syn)
syn_data_2 <- syn_data_2 %>%
slice(1:length(country_data_2)) %>%
mutate(Culture = country_data_2)
write.csv(syn_data_2$syn,
file = here('data/cross-cultural',
"GlobalGratitude_Responsibilism_Syn.csv"),
row.names = F)
# specify directory
i_am("code/GlobalGratitude_CrossCulturalMods.R")
# main data country_code
DF_main <-
readRDS(file = here("data/final-data",
"GlobalGratitude_Final_Cleaned.Rds"))
DF_main <- DF_main %>%
mutate(
country_code = str_sub(lab, 1, 3)) %>%
filter(!is.na(country_code))
sampled <- unique(DF_main$country_code)
#relational mobility
DF_relation <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_RelationalMobility.csv"))
DF_relation <- DF_relation %>%
rename("country_name" = "COUNTRY") %>%
rename("relational_mobility" = "RMOBLM") %>%
mutate(country_name = ifelse(country_name == "USA",
"United States",
country_name)) %>%
mutate(country_code = countrycode(country_name,
origin = "country.name",
destination = "iso3c")) %>%
select(country_code, country_name,
relational_mobility)
DF_respon_syn <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism_Syn.csv"))
#Load data (Responsibilism)
data_2 <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism.csv")) %>%
select(Culture:Responsibilism) %>%
filter(Culture != "", Culture != "Total")
country_data_2 <- unique(data_2$Culture)
set.seed(123)
#create synthetic version
syn_data_2 <- syn(
data_2,
maxfaclevels = 100
)
syn_data_2 <- (syn_data_2$syn)
View(syn_data_2)
syn_data_2 <- syn_data_2 %>%
slice(1:length(country_data_2)) %>%
mutate(Culture = country_data_2)
View(syn_data_2)
write.csv(syn_data_2,
file = here('data/cross-cultural',
"GlobalGratitude_Responsibilism_Syn.csv"),
row.names = F)
DF_respon_syn <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism_Syn.csv"))
DF_respon_syn <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism_Syn.csv"))
DF_respon_syn <- DF_respon_syn %>%
rename("country_name" = "Culture") %>%
rename("responsibilism" = "Responsibilism") %>%
select(country_name:responsibilism) %>%
filter(country_name != "",
country_name != "Total") %>%
mutate(country_code = countrycode(country_name,
origin = "country.name",
destination = "iso3c")) %>%
mutate(country_name = ifelse(country_name == "UK",
"United Kingdom",
country_name))  %>%
mutate(country_name = ifelse(country_name == "Macedonia",
"North Macedonia",
country_name))
library(countrycode)
library(tidyverse)
library(here)
# specify directory
i_am("code/GlobalGratitude_CrossCulturalMods.R")
# main data country_code
DF_main <-
readRDS(file = here("data/final-data",
"GlobalGratitude_Final_Cleaned.Rds"))
DF_main <- DF_main %>%
mutate(
country_code = str_sub(lab, 1, 3)) %>%
filter(!is.na(country_code))
sampled <- unique(DF_main$country_code)
#relational mobility
DF_relation <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_RelationalMobility.csv"))
DF_relation <- DF_relation %>%
rename("country_name" = "COUNTRY") %>%
rename("relational_mobility" = "RMOBLM") %>%
mutate(country_name = ifelse(country_name == "USA",
"United States",
country_name)) %>%
mutate(country_code = countrycode(country_name,
origin = "country.name",
destination = "iso3c")) %>%
select(country_code, country_name,
relational_mobility)
DF_respon_syn <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Responsibilism_Syn.csv"))
DF_respon_syn <- DF_respon_syn %>%
rename("country_name" = "Culture") %>%
rename("responsibilism" = "Responsibilism") %>%
select(country_name:responsibilism) %>%
filter(country_name != "",
country_name != "Total") %>%
mutate(country_code = countrycode(country_name,
origin = "country.name",
destination = "iso3c")) %>%
mutate(country_name = ifelse(country_name == "UK",
"United Kingdom",
country_name))  %>%
mutate(country_name = ifelse(country_name == "Macedonia",
"North Macedonia",
country_name))
DF_GDP <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_GDPpc.csv"))
DF_GDP <- DF_GDP %>%
rename("country_code" = "Country.Code") %>%
select(country_code, X2011:X2020) %>%
mutate(country_name = countrycode(country_code,
origin = "iso3c",
destination = "country.name")) %>%
mutate(mean_GDP = rowMeans(select(., X2011:X2020),
na.rm = TRUE)) %>%
select(country_code, country_name, mean_GDP)
DF_GDP <- DF_GDP %>%
filter(country_name != "NA")
DF_tight <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Tightness.csv")) %>%
rename(country_name = Country) %>%
mutate(country_code = countrycode(country_name,
origin = 'country.name',
destination = 'iso3c')) %>%
select(tightness = Tightness,
country_code,
country_name)
DF_indcol_syn <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_Hofstede_ResMobility_Syn.csv"))
DF_indcol <- DF_indcol %>%
mutate(country_code = countrycode(Matched,
origin = 'country.name',
destination = 'iso3c')) %>%
mutate(country_name = countrycode(country_code,
origin = "iso3c",
destination = "country.name")) %>%
select(resmobility:country_name)
DF_indcol_syn <- DF_indcol_syn %>%
mutate(country_code = countrycode(Matched,
origin = 'country.name',
destination = 'iso3c')) %>%
mutate(country_name = countrycode(country_code,
origin = "iso3c",
destination = "country.name")) %>%
select(resmobility:country_name)
View(DF_indcol_syn)
DF_relig <- read.csv(file = here("data/cross-cultural",
"GlobalGratitude_WorldReligiosity.csv")) %>%
rename("country_name" = "country") %>%
mutate(country_code = countrycode(country_name,
origin = 'country.name',
destination = 'iso3c')) %>%
select(X2011:X2014, country_name, country_code) %>%
mutate(
relig_mean = rowMeans(
cbind(X2011, X2012, X2013, X2014),
na.rm = TRUE)) %>%
select(country_code, country_name, relig_mean) %>%
mutate(country_name = ifelse(country_name == "Macedonia",
"North Macedonia", country_name))
#combine datasets (synthetic)
DF_combined_syn <- DF_relation %>%
full_join(DF_respon_syn, by = c("country_name", "country_code")) %>%
full_join(DF_tight, by = c("country_name", "country_code")) %>%
full_join(DF_relig, by = c("country_name", "country_code")) %>%
full_join(DF_GDP, by = c("country_name", "country_code")) %>%
full_join(DF_indcol_syn, by = c("country_name", "country_code")) %>%
filter(!is.na(country_name))
DF_combined_syn$sample <- ifelse(DF_combined_syn$country_code %in% sampled,
"yes",
"no")
DF_combined_syn <- DF_combined_syn %>%
mutate(country_name = ifelse(country_name == "North Macedonia",
"Macedonia",
country_name))
write.csv(DF_combined_syn,
file = here('data/final-data',
"GlobalGratitude_CrossCulturalMod_Syn.csv"),
row.names = F)
library(tidyverse)
library(here)
library(countrycode)
library(cowplot)
library(ggplot2)
library(dplyr)
options(scipen = 999)
i_am('code/Figure1.Rmd')
country.DF <-
# open data
read.csv(here('data/output',
'unique_country_effect_sizes.csv'
)
) %>%
# select relevant outcomes
select(
pa_effect_size,
na_effect_size,
optimistic_effect_size,
ls_effect_size,
envy_effect_size,
indebted_effect_size,
country) %>%
# summarise
group_by(country) %>%
summarise(across(everything(), mean, na.rm = TRUE))
mod.DF <-
read.csv(here('data/final-data',
'GlobalGratitude_CrossCulturalMod.csv'
)
) %>%
mutate(country = country_name) %>%
select(-c(country_code,
country_name))
# join
DF <-
left_join(x = country.DF,
y = mod.DF,
by = "country") %>%
mutate(iso =
countrycode(country,
origin = "country.name",
destination = "iso3c")
)
# cultural distance
# renamed columns to match with DF
DF.cd <- read.csv(here('data/cross-cultural',
"culturaldistance_table_combined.csv")) %>%
select(Name, United.States1981.2014) %>%
rename(country = Name,
dist.us = United.States1981.2014) %>%
mutate(country = str_remove_all(country, "[:digit:]"),
country = str_remove_all(country, "-")) %>%
mutate(country = ifelse(country == "Great Britain", "United Kingdom", country))
DF2 <- left_join(DF.cd,
DF,
by = 'country')
library(scales)
DF2 <-
DF2 %>%
mutate(dist.us =
replace_na(dist.us,
0)) %>%
mutate_at(.vars = vars(dist.us,
relational_mobility : indulgence),
~ rescale(x = .,
to = c(-1, 1)))
DF2 <- DF2 %>%
mutate(
sampled =
if_else(is.na(pa_effect_size),
'no',
'yes'),
country =
countrycode(country,
origin = "country.name",
destination = "iso3c")
)
fig.1a <-
ggplot(
data = DF2,
aes(x = dist.us,
y = .2)) +
# Population density (all countries)
geom_density(
data = DF2,
aes(x = dist.us,
y = ..scaled..),
color = "grey80",
alpha = 0.5) +
# sample density (sampled countries)
geom_density(
data = DF2 %>%
filter(sampled == "yes"),
aes(x = dist.us,
y = ..scaled..),
color = "#3C5488",
alpha = 0.5) +
# rug lines: unsampled countries
geom_linerange(
data = DF2 %>% filter(sampled == "no"),
aes(ymin = 0, ymax = 0.1),
color = 'grey50') +
# rug lines: sampled countries
geom_linerange(
data = DF2 %>% filter(sampled == "yes"),
aes(ymin = 0, ymax = 0.2,
color = country)) +
# country labels
geom_text(
data = DF2 %>% filter(sampled == "yes"),
aes(label = country,
color = country,
y = 1),
position = position_jitter(height = .75)) +
# theme
theme_classic() +
theme(
legend.position = 'none',
axis.title.y = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line.y = element_blank(),
strip.background = element_blank()
) +
xlab('Cultural distance (from USA)')
fig1.DF.new <-
mod.DF %>%
pivot_longer(relational_mobility : indulgence) %>%
mutate(
name =
fct_recode(name,
"Relational mobility" = "relational_mobility",
"Responsibilism" = "responsibilism",
"Tightness" = "tightness",
"Religiosity" = "relig_mean",
"GDP" = "mean_GDP",
"Residential mobility" = "resmobility",
"Power distance" = "power.distance",
"Individualism" = "individualism",
"Motivation" = "motivation",
"Uncertainty avoidance" = "uncertainty.avoidance",
"Long term orientation" = "long.term.orientation",
"Indulgence" = "indulgence")
)
fig.1c <-
ggplot(data = fig1.DF.new,
aes(x = value)) +
# facet wrap
facet_wrap(~ name,
scales = 'free',
strip.position = 'bottom') +
# plot all countries
geom_density(alpha = .5,
color = 'grey70') +
# plot sampled countries
geom_density(data = fig1.DF.new %>%
filter(sample == 'yes'),
alpha = .5,
color = '#3C5488') +
theme_classic() +
theme(
legend.position = 'none',
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
strip.placement = "outside",
strip.background = element_blank()
)
fig.1c
country.DF <-
# open data
read.csv(here('data/output',
'unique_country_effect_sizes.csv'
)
) %>%
# select relevant outcomes
select(
pa_effect_size,
na_effect_size,
optimistic_effect_size,
ls_effect_size,
envy_effect_size,
indebted_effect_size,
country) %>%
# summarise
group_by(country) %>%
summarise(across(everything(), mean, na.rm = TRUE))
mod.DF <-
read.csv(here('data/final-data',
'GlobalGratitude_CrossCulturalMod_Syn.csv'
)
) %>%
mutate(country = country_name) %>%
select(-c(country_code,
country_name))
fig1.DF.new <-
mod.DF %>%
pivot_longer(relational_mobility : indulgence) %>%
mutate(
name =
fct_recode(name,
"Relational mobility" = "relational_mobility",
"Responsibilism" = "responsibilism",
"Tightness" = "tightness",
"Religiosity" = "relig_mean",
"GDP" = "mean_GDP",
"Residential mobility" = "resmobility",
"Power distance" = "power.distance",
"Individualism" = "individualism",
"Motivation" = "motivation",
"Uncertainty avoidance" = "uncertainty.avoidance",
"Long term orientation" = "long.term.orientation",
"Indulgence" = "indulgence")
)
fig.1c <-
ggplot(data = fig1.DF.new,
aes(x = value)) +
# facet wrap
facet_wrap(~ name,
scales = 'free',
strip.position = 'bottom') +
# plot all countries
geom_density(alpha = .5,
color = 'grey70') +
# plot sampled countries
geom_density(data = fig1.DF.new %>%
filter(sample == 'yes'),
alpha = .5,
color = '#3C5488') +
theme_classic() +
theme(
legend.position = 'none',
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
strip.placement = "outside",
strip.background = element_blank()
)
fig.1c
